# ************************************************************
# Sequel Pro SQL dump
# Version 4541
#
# http://www.sequelpro.com/
# https://github.com/sequelpro/sequelpro
#
# Host: 127.0.0.1 (MySQL 5.7.30)
# Database: admin_starter
# Generation Time: 2025-09-05 05:19:21 +0000
# ************************************************************


/*!40101 SET @OLD_CHARACTER_SET_CLIENT=@@CHARACTER_SET_CLIENT */;
/*!40101 SET @OLD_CHARACTER_SET_RESULTS=@@CHARACTER_SET_RESULTS */;
/*!40101 SET @OLD_COLLATION_CONNECTION=@@COLLATION_CONNECTION */;
/*!40101 SET NAMES utf8 */;
/*!40014 SET @OLD_FOREIGN_KEY_CHECKS=@@FOREIGN_KEY_CHECKS, FOREIGN_KEY_CHECKS=0 */;
/*!40101 SET @OLD_SQL_MODE=@@SQL_MODE, SQL_MODE='NO_AUTO_VALUE_ON_ZERO' */;
/*!40111 SET @OLD_SQL_NOTES=@@SQL_NOTES, SQL_NOTES=0 */;


# Dump of table Devices
# ------------------------------------------------------------

DROP TABLE IF EXISTS `Devices`;

CREATE TABLE `Devices` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `devId` varchar(50) COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '设备ID',
  `name` varchar(100) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT '设备名称',
  `status` enum('active','inactive','offline') COLLATE utf8mb4_unicode_ci DEFAULT 'active' COMMENT '设备状态',
  `description` text COLLATE utf8mb4_unicode_ci COMMENT '设备描述',
  `lastActiveTime` datetime DEFAULT NULL COMMENT '最后活跃时间',
  `createdAt` datetime NOT NULL,
  `updatedAt` datetime NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `devId` (`devId`),
  KEY `status` (`status`),
  KEY `devices_dev_id` (`devId`),
  KEY `devices_status` (`status`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

LOCK TABLES `Devices` WRITE;
/*!40000 ALTER TABLE `Devices` DISABLE KEYS */;

INSERT INTO `Devices` (`id`, `devId`, `name`, `status`, `description`, `lastActiveTime`, `createdAt`, `updatedAt`)
VALUES
	(1,'1091a8443428','第一个设备','active','开发版第一个机器','2025-09-05 12:09:16','2025-09-03 13:51:05','2025-09-05 12:09:16');

/*!40000 ALTER TABLE `Devices` ENABLE KEYS */;
UNLOCK TABLES;


# Dump of table ForwardSettings
# ------------------------------------------------------------

DROP TABLE IF EXISTS `ForwardSettings`;

CREATE TABLE `ForwardSettings` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `platform` enum('telegram','bark','webhook','wxpusher') COLLATE utf8mb4_unicode_ci NOT NULL COMMENT '转发平台',
  `enabled` tinyint(1) DEFAULT '0' COMMENT '是否启用',
  `config` json DEFAULT NULL COMMENT '平台配置信息',
  `filterRules` json DEFAULT NULL COMMENT '过滤规则',
  `messageTemplate` text COLLATE utf8mb4_unicode_ci COMMENT '消息模板',
  `lastForwardTime` datetime DEFAULT NULL COMMENT '最后转发时间',
  `forwardCount` int(11) DEFAULT '0' COMMENT '转发计数',
  `failCount` int(11) DEFAULT '0' COMMENT '失败计数',
  `createdAt` datetime NOT NULL,
  `updatedAt` datetime NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `platform` (`platform`),
  KEY `enabled` (`enabled`),
  KEY `forward_settings_platform` (`platform`),
  KEY `forward_settings_enabled` (`enabled`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

LOCK TABLES `ForwardSettings` WRITE;
/*!40000 ALTER TABLE `ForwardSettings` DISABLE KEYS */;

INSERT INTO `ForwardSettings` (`id`, `platform`, `enabled`, `config`, `filterRules`, `messageTemplate`, `lastForwardTime`, `forwardCount`, `failCount`, `createdAt`, `updatedAt`)
VALUES
	(1,'telegram',1,X'7B2270726F7879223A207B22656E61626C6564223A2066616C73657D2C2022636861744964223A2022373231303438363631222C2022626F74546F6B656E223A2022383237313931343338383A4141487239626959364977644564664E62325145366147416B33704C304576427A3641222C202270617273654D6F6465223A202248544D4C222C202273696C656E744D6F6465223A2066616C73657D',X'7B2264657669636573223A205B5D2C202273656E64657273223A205B5D2C20226B6579776F726473223A205B5D2C202273696D4361726473223A205B5D7D','? 新短信\n设备: {device}\nSIM卡: {simcard}\n发送方: {sender}\n内容: {content}\n时间: {time}','2025-09-05 12:09:17',6,0,'2025-09-03 13:58:59','2025-09-05 12:09:17'),
	(2,'bark',1,X'7B2275726C223A2022222C202269636F6E223A202268747470733A2F2F6461792E6170702F6173736574732F696D616765732F6176617461722E6A7067222C202275696473223A20225549445F4977693673524C734C4174755A76654C4E4F3866596F754B46463250222C202267726F7570223A2022E79FADE4BFA1E68EA5E694B6222C202270726F7879223A207B22656E61626C6564223A2066616C73657D2C2022736F756E64223A202264656661756C74222C2022636861744964223A2022373231303438363631222C2022617070546F6B656E223A202241545F6A7754763966727539303366687A635664747451773133423336434476736673222C2022626F74546F6B656E223A2022383237313931343338383A4141487239626959364977644564664E62325145366147416B33704C304576427A3641222C2022746F706963496473223A205B5D2C20226465766963654B6579223A202252656B4370764A37435239686835655A693732755164222C2022697341726368697665223A20747275652C202270617273654D6F6465223A202248544D4C222C202273657276657255726C223A202268747470733A2F2F6170692E6461792E617070222C202273696C656E744D6F6465223A2066616C73657D',X'7B2264657669636573223A205B5D2C202273656E64657273223A205B5D2C20226B6579776F726473223A205B5D2C202273696D4361726473223A205B5D7D','? 新短信\n设备: {device}\nSIM卡: {simcard}\n发送方: {sender}\n内容: {content}\n时间: {time}','2025-09-05 12:09:17',3,0,'2025-09-03 13:58:59','2025-09-05 12:09:17'),
	(3,'webhook',0,X'7B2275726C223A2022222C20226D6574686F64223A2022504F5354222C202268656164657273223A207B7D2C202274696D656F7574223A2031303030307D',X'7B2264657669636573223A205B5D2C202273656E64657273223A205B5D2C20226B6579776F726473223A205B5D2C202273696D4361726473223A205B5D7D','? 新短信\n设备: {device}\nSIM卡: {simcard}\n发送方: {sender}\n内容: {content}\n时间: {time}',NULL,0,0,'2025-09-03 13:58:59','2025-09-03 13:58:59'),
	(4,'wxpusher',1,X'7B2275726C223A2022222C202275696473223A20225549445F4977693673524C734C4174755A76654C4E4F3866596F754B46463250222C202270726F7879223A207B22656E61626C6564223A2066616C73657D2C2022636861744964223A2022373231303438363631222C2022617070546F6B656E223A202241545F6A7754763966727539303366687A635664747451773133423336434476736673222C2022626F74546F6B656E223A2022383237313931343338383A4141487239626959364977644564664E62325145366147416B33704C304576427A3641222C2022746F706963496473223A205B5D2C202270617273654D6F6465223A202248544D4C222C202273696C656E744D6F6465223A2066616C73657D',X'7B2264657669636573223A205B5D2C202273656E64657273223A205B5D2C20226B6579776F726473223A205B5D2C202273696D4361726473223A205B5D7D','? 新短信\n设备: {device}\nSIM卡: {simcard}\n发送方: {sender}\n内容: {content}\n时间: {time}','2025-09-05 12:09:17',3,3,'0000-00-00 00:00:00','2025-09-05 12:09:17');

/*!40000 ALTER TABLE `ForwardSettings` ENABLE KEYS */;
UNLOCK TABLES;


# Dump of table SimCards
# ------------------------------------------------------------

DROP TABLE IF EXISTS `SimCards`;

CREATE TABLE `SimCards` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `deviceId` int(11) NOT NULL COMMENT '关联的设备ID',
  `slot` int(11) NOT NULL COMMENT '卡槽位置（1或2）',
  `msIsdn` varchar(20) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '手机号码MSISDN',
  `imsi` varchar(50) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT 'IMSI号',
  `iccId` varchar(50) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT 'ICC ID',
  `scName` varchar(100) COLLATE utf8mb4_unicode_ci DEFAULT '' COMMENT 'SIM卡名称/备注',
  `status` enum('202','203','204','205','209') COLLATE utf8mb4_unicode_ci DEFAULT '204' COMMENT 'SIM卡状态：202基站注册中，203ID已读取，204已就绪，205已弹出，209卡异常',
  `lastActiveTime` datetime DEFAULT NULL COMMENT '最后活跃时间',
  `createdAt` datetime NOT NULL,
  `updatedAt` datetime NOT NULL,
  PRIMARY KEY (`id`),
  UNIQUE KEY `SimCards_deviceId_slot` (`deviceId`,`slot`),
  UNIQUE KEY `sim_cards_device_id_slot` (`deviceId`,`slot`),
  KEY `deviceId` (`deviceId`),
  CONSTRAINT `simcards_ibfk_1` FOREIGN KEY (`deviceId`) REFERENCES `Devices` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

LOCK TABLES `SimCards` WRITE;
/*!40000 ALTER TABLE `SimCards` DISABLE KEYS */;

INSERT INTO `SimCards` (`id`, `deviceId`, `slot`, `msIsdn`, `imsi`, `iccId`, `scName`, `status`, `lastActiveTime`, `createdAt`, `updatedAt`)
VALUES
	(1,1,1,'10684717700002315205','460012810115581','89860118802476524938','联通保号卡','204','2025-09-05 12:09:16','2025-09-03 13:51:05','2025-09-05 12:09:16'),
	(2,1,2,'#ClubSi','454003063040863','8985200014630408634F','香港clubsim卡','204','2025-09-05 08:10:33','2025-09-03 13:51:05','2025-09-05 08:10:33');

/*!40000 ALTER TABLE `SimCards` ENABLE KEYS */;
UNLOCK TABLES;


# Dump of table SmsMessages
# ------------------------------------------------------------

DROP TABLE IF EXISTS `SmsMessages`;

CREATE TABLE `SmsMessages` (
  `id` int(11) NOT NULL AUTO_INCREMENT,
  `simCardId` int(11) NOT NULL COMMENT '关联的SIM卡ID',
  `deviceId` int(11) NOT NULL COMMENT '关联的设备ID',
  `netCh` int(11) DEFAULT NULL COMMENT '网络通道号（0=wifi，1=卡槽一）',
  `msgTs` bigint(20) DEFAULT NULL COMMENT '消息时间戳',
  `phNum` varchar(20) COLLATE utf8mb4_unicode_ci DEFAULT NULL COMMENT '发送方手机号',
  `smsBd` text COLLATE utf8mb4_unicode_ci COMMENT '短信内容',
  `smsTs` bigint(20) DEFAULT NULL COMMENT '短信时间戳',
  `rawData` json DEFAULT NULL COMMENT '原始数据',
  `createdAt` datetime NOT NULL,
  `updatedAt` datetime NOT NULL,
  PRIMARY KEY (`id`),
  KEY `simCardId` (`simCardId`),
  KEY `deviceId` (`deviceId`),
  KEY `phNum` (`phNum`),
  KEY `createdAt` (`createdAt`),
  KEY `sms_messages_sim_card_id` (`simCardId`),
  KEY `sms_messages_device_id` (`deviceId`),
  KEY `sms_messages_ph_num` (`phNum`),
  KEY `sms_messages_created_at` (`createdAt`),
  CONSTRAINT `smsmessages_ibfk_117` FOREIGN KEY (`simCardId`) REFERENCES `SimCards` (`id`) ON DELETE CASCADE ON UPDATE CASCADE,
  CONSTRAINT `smsmessages_ibfk_118` FOREIGN KEY (`deviceId`) REFERENCES `Devices` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci;

LOCK TABLES `SmsMessages` WRITE;
/*!40000 ALTER TABLE `SmsMessages` DISABLE KEYS */;

INSERT INTO `SmsMessages` (`id`, `simCardId`, `deviceId`, `netCh`, `msgTs`, `phNum`, `smsBd`, `smsTs`, `rawData`, `createdAt`, `updatedAt`)
VALUES
	(1,1,1,0,1756882020,'+8618628349353','今天阅兵',1756882020,X'7B22696D7369223A2022343630303132383130313135353831222C2022736C6F74223A20312C202274797065223A203530312C20226465764964223A2022313039316138343433343238222C20226963634964223A20223839383630313138383032343736353234393338222C20226D73675473223A20313735363838323032302C20226E65744368223A20302C202270684E756D223A20222B38363138363238333439333533222C2022736D734264223A2022E4BB8AE5A4A9E99885E585B5222C2022736D735473223A20313735363838323032302C20226D734973646E223A20222B38363137363032383136363132222C202273634E616D65223A2022E88194E9809AE4BF9DE58FB7E58DA1222C202263686172736574223A202275746638222C2022646576536D735473223A20313735363838323032307D','2025-09-03 14:47:03','2025-09-03 14:47:03'),
	(2,1,1,0,1756882023,'106878632488111803','【大悦城】尊敬的璀璨卡会员，生日月快乐！本月消费享双倍积分，凭身份证件可到店可领百元专属零售券，数量有限，领完即止。拒收请回复R',1756695691,X'7B22696D7369223A2022343630303132383130313135353831222C2022736C6F74223A20312C202274797065223A203530312C20226465764964223A2022313039316138343433343238222C20226963634964223A20223839383630313138383032343736353234393338222C20226D73675473223A20313735363838323032332C20226E65744368223A20302C202270684E756D223A2022313036383738363332343838313131383033222C2022736D734264223A2022E38090E5A4A7E682A6E59F8EE38091E5B08AE695ACE79A84E79280E792A8E58DA1E4BC9AE59198EFBC8CE7949FE697A5E69C88E5BFABE4B990EFBC81E69CACE69C88E6B688E8B4B9E4BAABE58F8CE5808DE7A7AFE58886EFBC8CE587ADE8BAABE4BBBDE8AF81E4BBB6E58FAFE588B0E5BA97E58FAFE9A286E799BEE58583E4B893E5B19EE99BB6E594AEE588B8EFBC8CE695B0E9878FE69C89E99990EFBC8CE9A286E5AE8CE58DB3E6ADA2E38082E68B92E694B6E8AFB7E59B9EE5A48D52222C2022736D735473223A20313735363639353639312C20226D734973646E223A20222B38363137363032383136363132222C202273634E616D65223A2022E88194E9809AE4BF9DE58FB7E58DA1222C202263686172736574223A202275746638222C2022646576536D735473223A20313735363838323032337D','2025-09-03 14:47:06','2025-09-03 14:47:06'),
	(3,1,1,0,1756882081,'+8618628349353','基督教的角度讲',1756882081,X'7B22696D7369223A2022343630303132383130313135353831222C2022736C6F74223A20312C202274797065223A203530312C20226465764964223A2022313039316138343433343238222C20226963634964223A20223839383630313138383032343736353234393338222C20226D73675473223A20313735363838323038312C20226E65744368223A20302C202270684E756D223A20222B38363138363238333439333533222C2022736D734264223A2022E59FBAE79DA3E69599E79A84E8A792E5BAA6E8AEB2222C2022736D735473223A20313735363838323038312C20226D734973646E223A20222B38363137363032383136363132222C202273634E616D65223A2022E88194E9809AE4BF9DE58FB7E58DA1222C202263686172736574223A202275746638222C2022646576536D735473223A20313735363838323038317D','2025-09-03 14:48:04','2025-09-03 14:48:04'),
	(4,2,1,0,1756882213,'#ClubSi','Club Sim服務提示: 你現在身處中國內地！你尚餘數據漫遊通行證(2 張)。請啟動手機「數據漫遊」功能，以使用數據服務。如有任何查詢，可透過Club Sim app入面嘅WhatsApp 客戶服務 或打1833 123同客戶服務主任聯絡。',1756882211,X'7B22636F6D70223A20747275652C2022696D7369223A2022343534303033303633303430383633222C2022736C6F74223A20322C202274797065223A203530312C20226465764964223A2022313039316138343433343238222C20226963634964223A20223839383532303030313436333034303836333446222C20226D73675473223A20313735363838323231332C20226E65744368223A20302C202270684E756D223A202223436C75625369222C2022736D734264223A2022436C75622053696DE69C8DE58B99E68F90E7A4BA3A20E4BDA0E78FBEE59CA8E8BAABE89995E4B8ADE59C8BE585A7E59CB0EFBC81E4BDA0E5B09AE9A498E695B8E6939AE6BCABE9818AE9809AE8A18CE8AD89283220E5BCB529E38082E8AB8BE5959FE58B95E6898BE6A99FE3808CE695B8E6939AE6BCABE9818AE3808DE58A9FE883BDEFBC8CE4BBA5E4BDBFE794A8E695B8E6939AE69C8DE58B99E38082E5A682E69C89E4BBBBE4BD95E69FA5E8A9A2EFBC8CE58FAFE9808FE9818E436C75622053696D20617070E585A5E99DA2E59885576861747341707020E5AEA2E688B6E69C8DE58B9920E68896E689933138333320313233E5908CE5AEA2E688B6E69C8DE58B99E4B8BBE4BBBBE881AFE7B5A1E38082222C2022736D735473223A20313735363838323231312C20226D734973646E223A20222B3835323639373630333439222C202273634E616D65223A2022E9A699E6B8AF636C756273696DE58DA1222C202263686172736574223A202275746638222C2022646576536D735473223A20313735363838323231332C2022736D734D61784E6F223A20322C2022736D735265664E6F223A203231372C2022736D7347726F75704964223A2022324530353431353335354535227D','2025-09-03 14:50:16','2025-09-03 14:50:16'),
	(5,2,1,0,1756882224,'#ClubSi','[Club Sim優惠]透過Club Sim app隨時追加數據漫遊通行證! 詳情：https://clubsim.page.link/travel。查詢/取消: 1833 123',1756882222,X'7B22636F6D70223A20747275652C2022696D7369223A2022343534303033303633303430383633222C2022736C6F74223A20322C202274797065223A203530312C20226465764964223A2022313039316138343433343238222C20226963634964223A20223839383532303030313436333034303836333446222C20226D73675473223A20313735363838323232342C20226E65744368223A20302C202270684E756D223A202223436C75625369222C2022736D734264223A20225B436C75622053696DE584AAE683A05DE9808FE9818E436C75622053696D20617070E99AA8E69982E8BFBDE58AA0E695B8E6939AE6BCABE9818AE9809AE8A18CE8AD892120E8A9B3E68385EFBC9A68747470733A2F2F636C756273696D2E706167652E6C696E6B2F74726176656CE38082E69FA5E8A9A22FE58F96E6B6883A203138333320313233222C2022736D735473223A20313735363838323232322C20226D734973646E223A20222B3835323639373630333439222C202273634E616D65223A2022E9A699E6B8AF636C756273696DE58DA1222C202263686172736574223A202275746638222C2022646576536D735473223A20313735363838323232342C2022736D734D61784E6F223A20322C2022736D735265664E6F223A2035332C2022736D7347726F75704964223A2022314446303839424446423141227D','2025-09-03 14:50:27','2025-09-03 14:50:27'),
	(6,1,1,0,1756977153,'10010','验证码：160447，短信验证码2分钟内有效，请勿泄漏给他人。【中国联通】',1756977153,X'7B22696D7369223A2022343630303132383130313135353831222C2022736C6F74223A20312C202274797065223A203530312C20226465764964223A2022313039316138343433343238222C20226963634964223A20223839383630313138383032343736353234393338222C20226D73675473223A20313735363937373135332C20226E65744368223A20302C202270684E756D223A20223130303130222C2022736D734264223A2022E9AA8CE8AF81E7A081EFBC9A313630343437EFBC8CE79FADE4BFA1E9AA8CE8AF81E7A08132E58886E9929FE58685E69C89E69588EFBC8CE8AFB7E58BBFE6B384E6BC8FE7BB99E4BB96E4BABAE38082E38090E4B8ADE59BBDE88194E9809AE38091222C2022736D735473223A20313735363937373135332C20226D734973646E223A20222B38363137363032383136363132222C202273634E616D65223A2022E88194E9809AE4BF9DE58FB7E58DA1222C202263686172736574223A202275746638222C2022646576536D735473223A20313735363937373135337D','2025-09-04 17:12:37','2025-09-04 17:12:37'),
	(7,1,1,0,1756977395,'10010','验证码：850951，短信验证码2分钟内有效，请勿泄漏给他人。【中国联通】',1756977395,X'7B22696D7369223A2022343630303132383130313135353831222C2022736C6F74223A20312C202274797065223A203530312C20226465764964223A2022313039316138343433343238222C20226963634964223A20223839383630313138383032343736353234393338222C20226D73675473223A20313735363937373339352C20226E65744368223A20302C202270684E756D223A20223130303130222C2022736D734264223A2022E9AA8CE8AF81E7A081EFBC9A383530393531EFBC8CE79FADE4BFA1E9AA8CE8AF81E7A08132E58886E9929FE58685E69C89E69588EFBC8CE8AFB7E58BBFE6B384E6BC8FE7BB99E4BB96E4BABAE38082E38090E4B8ADE59BBDE88194E9809AE38091222C2022736D735473223A20313735363937373339352C20226D734973646E223A20222B38363137363032383136363132222C202273634E616D65223A2022E88194E9809AE4BF9DE58FB7E58DA1222C202263686172736574223A202275746638222C2022646576536D735473223A20313735363937373339357D','2025-09-04 17:16:38','2025-09-04 17:16:38'),
	(8,1,1,0,1756977467,'10010','温馨提示：您于04日17时17分交费200元，账户当前可用余额为318.58元。点击进入 https://u.10010.cn/uAATg 查询详情。【中国联通】',1756977467,X'7B22636F6D70223A20747275652C2022696D7369223A2022343630303132383130313135353831222C2022736C6F74223A20312C202274797065223A203530312C20226465764964223A2022313039316138343433343238222C20226963634964223A20223839383630313138383032343736353234393338222C20226D73675473223A20313735363937373436372C20226E65744368223A20302C202270684E756D223A20223130303130222C2022736D734264223A2022E6B8A9E9A6A8E68F90E7A4BAEFBC9AE682A8E4BA8E3034E697A53137E697B63137E58886E4BAA4E8B4B9323030E58583EFBC8CE8B4A6E688B7E5BD93E5898DE58FAFE794A8E4BD99E9A29DE4B8BA3331382E3538E58583E38082E782B9E587BBE8BF9BE585A52068747470733A2F2F752E31303031302E636E2F754141546720E69FA5E8AFA2E8AFA6E68385E38082E38090E4B8ADE59BBDE88194E9809AE38091222C2022736D735473223A20313735363937373436372C20226D734973646E223A20222B38363137363032383136363132222C202273634E616D65223A2022E88194E9809AE4BF9DE58FB7E58DA1222C202263686172736574223A202275746638222C2022646576536D735473223A20313735363937373436372C2022736D734D61784E6F223A20322C2022736D735265664E6F223A203132372C2022736D7347726F75704964223A2022313242323642303546353935227D','2025-09-04 17:17:50','2025-09-04 17:17:50'),
	(9,2,1,0,1757031014,'#ClubSi','Club Sim服務提示: 你現在身處中國內地！你尚餘數據漫遊通行證(2 張)。請啟動手機「數據漫遊」功能，以使用數據服務。如有任何查詢，可透過Club Sim app入面嘅WhatsApp 客戶服務 或打1833 123同客戶服務主任聯絡。',1757031011,X'7B22636F6D70223A20747275652C2022696D7369223A2022343534303033303633303430383633222C2022736C6F74223A20322C202274797065223A203530312C20226465764964223A2022313039316138343433343238222C20226963634964223A20223839383532303030313436333034303836333446222C20226D73675473223A20313735373033313031342C20226E65744368223A20302C202270684E756D223A202223436C75625369222C2022736D734264223A2022436C75622053696DE69C8DE58B99E68F90E7A4BA3A20E4BDA0E78FBEE59CA8E8BAABE89995E4B8ADE59C8BE585A7E59CB0EFBC81E4BDA0E5B09AE9A498E695B8E6939AE6BCABE9818AE9809AE8A18CE8AD89283220E5BCB529E38082E8AB8BE5959FE58B95E6898BE6A99FE3808CE695B8E6939AE6BCABE9818AE3808DE58A9FE883BDEFBC8CE4BBA5E4BDBFE794A8E695B8E6939AE69C8DE58B99E38082E5A682E69C89E4BBBBE4BD95E69FA5E8A9A2EFBC8CE58FAFE9808FE9818E436C75622053696D20617070E585A5E99DA2E59885576861747341707020E5AEA2E688B6E69C8DE58B9920E68896E689933138333320313233E5908CE5AEA2E688B6E69C8DE58B99E4B8BBE4BBBBE881AFE7B5A1E38082222C2022736D735473223A20313735373033313031312C20226D734973646E223A20222B3835323639373630333439222C202273634E616D65223A2022E9A699E6B8AF636C756273696DE58DA1222C202263686172736574223A202275746638222C2022646576536D735473223A20313735373033313031342C2022736D734D61784E6F223A20322C2022736D735265664E6F223A203139352C2022736D7347726F75704964223A2022384545443446363444343437227D','2025-09-05 08:10:28','2025-09-05 08:10:28'),
	(10,2,1,0,1757031018,'#ClubSi','[Club Sim優惠]透過Club Sim app隨時追加數據漫遊通行證! 詳情：https://clubsim.page.link/travel。查詢/取消: 1833 123',1757031017,X'7B22636F6D70223A20747275652C2022696D7369223A2022343534303033303633303430383633222C2022736C6F74223A20322C202274797065223A203530312C20226465764964223A2022313039316138343433343238222C20226963634964223A20223839383532303030313436333034303836333446222C20226D73675473223A20313735373033313031382C20226E65744368223A20302C202270684E756D223A202223436C75625369222C2022736D734264223A20225B436C75622053696DE584AAE683A05DE9808FE9818E436C75622053696D20617070E99AA8E69982E8BFBDE58AA0E695B8E6939AE6BCABE9818AE9809AE8A18CE8AD892120E8A9B3E68385EFBC9A68747470733A2F2F636C756273696D2E706167652E6C696E6B2F74726176656CE38082E69FA5E8A9A22FE58F96E6B6883A203138333320313233222C2022736D735473223A20313735373033313031372C20226D734973646E223A20222B3835323639373630333439222C202273634E616D65223A2022E9A699E6B8AF636C756273696DE58DA1222C202263686172736574223A202275746638222C2022646576536D735473223A20313735373033313031382C2022736D734D61784E6F223A20322C2022736D735265664E6F223A203132322C2022736D7347726F75704964223A2022423838363337323232413637227D','2025-09-05 08:10:33','2025-09-05 08:10:33'),
	(11,1,1,0,1757045341,'10684717700002315205','【支付宝】[AlipayHK]請輸入驗證碼以註冊AlipayHK賬戶：1015。驗證碼有效時限為60秒。為保障你的賬號安全，請勿轉發驗證碼。',1757045341,X'7B22696D7369223A2022343630303132383130313135353831222C2022736C6F74223A20312C202274797065223A203530312C20226465764964223A2022313039316138343433343238222C20226963634964223A20223839383630313138383032343736353234393338222C20226D73675473223A20313735373034353334312C20226E65744368223A20302C202270684E756D223A20223130363834373137373030303032333135323035222C2022736D734264223A2022E38090E694AFE4BB98E5AE9DE380915B416C69706179484B5DE8AB8BE8BCB8E585A5E9A997E8AD89E7A2BCE4BBA5E8A8BBE5868A416C69706179484BE8B3ACE688B6EFBC9A31303135E38082E9A997E8AD89E7A2BCE69C89E69588E69982E99990E782BA3630E7A792E38082E782BAE4BF9DE99A9CE4BDA0E79A84E8B3ACE8999FE5AE89E585A8EFBC8CE8AB8BE58BBFE8BD89E799BCE9A997E8AD89E7A2BCE38082222C2022736D735473223A20313735373034353334312C20226D734973646E223A20222B38363137363032383136363132222C202273634E616D65223A2022E88194E9809AE4BF9DE58FB7E58DA1222C202263686172736574223A202275746638222C2022646576536D735473223A20313735373034353334317D','2025-09-05 12:09:16','2025-09-05 12:09:16');

/*!40000 ALTER TABLE `SmsMessages` ENABLE KEYS */;


ALTER TABLE `SmsMessages` 
ADD COLUMN `msgType` enum('sms','call') DEFAULT 'sms' COMMENT '消息类型：sms-短信，call-来电' AFTER `deviceId`,
ADD COLUMN `callDuration` int DEFAULT NULL COMMENT '通话时长（秒）- 仅来电记录' AFTER `smsTs`,
ADD COLUMN `callStatus` varchar(20) DEFAULT NULL COMMENT '来电状态：ringing-响铃中，missed-未接，answered-已接听' AFTER `callDuration`,
ADD INDEX `idx_msgType` (`msgType`);


-- 1. 添加API控制相关字段
ALTER TABLE `Devices`
ADD COLUMN `apiUrl` varchar(255) DEFAULT NULL COMMENT '设备API接口地址' AFTER `description`,
ADD COLUMN `apiToken` varchar(255) DEFAULT NULL COMMENT '设备API访问令牌' AFTER `apiUrl`,
ADD COLUMN `apiEnabled` tinyint(1) DEFAULT '0' COMMENT '是否启用API控制' AFTER `apiToken`,
ADD COLUMN `lastApiCallTime` datetime DEFAULT NULL COMMENT '最后API调用时间' AFTER `lastActiveTime`,
ADD COLUMN `apiCallCount` int DEFAULT '0' COMMENT 'API调用次数' AFTER `lastApiCallTime`;



ALTER TABLE `SimCards`
ADD COLUMN `lastCallTime` datetime DEFAULT NULL COMMENT '最后来电时间' AFTER `status`,
ADD COLUMN `lastCallNumber` varchar(20) DEFAULT NULL COMMENT '最后来电号码' AFTER `lastCallTime`,
ADD COLUMN `callStatus` enum('idle', 'ringing', 'connected', 'ended') DEFAULT 'idle' COMMENT '通话状态：idle空闲，ringing响铃中，connected通话中，ended已结束' AFTER `lastCallNumber`;


-- 创建 TtsTemplates 表
CREATE TABLE IF NOT EXISTS `TtsTemplates` (
  `id` INT(11) NOT NULL AUTO_INCREMENT,
  `name` VARCHAR(100) NOT NULL COMMENT '模板名称',
  `content` TEXT NOT NULL COMMENT 'TTS语音内容',
  `isDefault` BOOLEAN DEFAULT 0 COMMENT '是否为默认模板',
  `sortOrder` INT(11) DEFAULT 0 COMMENT '排序顺序',
  `isActive` BOOLEAN DEFAULT 1 COMMENT '是否启用',
  `createdAt` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP,
  `updatedAt` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP,
  PRIMARY KEY (`id`),
  INDEX `idx_isDefault` (`isDefault`),
  INDEX `idx_isActive` (`isActive`),
  INDEX `idx_sortOrder` (`sortOrder`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='TTS语音模板表';

-- 插入一些默认的TTS模板数据
INSERT INTO `TtsTemplates` (`name`, `content`, `isDefault`, `sortOrder`, `isActive`) VALUES
('默认语音', '您好，这里暂时无人接听，请稍后再拨。', 1, 0, 1),
('验证码接收', '您好，正在接收验证码，请稍等。', 0, 1, 1),
('快递通知', '您好，快递已收到，谢谢。', 0, 2, 1),
('无人在家', '您好，现在不在家，请改天再联系。', 0, 3, 1),
('会议中', '您好，现在正在开会，稍后回电。', 0, 4, 1),
('忙碌中', '您好，现在有点忙，请稍后联系。', 0, 5, 1),
('外出中', '您好，我现在在外面，不方便接电话。', 0, 6, 1),
('驾驶中', '您好，正在开车，稍后联系您。', 0, 7, 1);

-- 确保只有一个默认模板
-- 创建触发器，当设置新的默认模板时，自动取消其他默认模板
DELIMITER $$
CREATE TRIGGER `before_tts_template_update` 
BEFORE UPDATE ON `TtsTemplates` 
FOR EACH ROW
BEGIN
    IF NEW.isDefault = 1 AND OLD.isDefault = 0 THEN
        UPDATE `TtsTemplates` SET `isDefault` = 0 WHERE `id` != NEW.id;
    END IF;
END$$

CREATE TRIGGER `before_tts_template_insert` 
BEFORE INSERT ON `TtsTemplates` 
FOR EACH ROW
BEGIN
    IF NEW.isDefault = 1 THEN
        UPDATE `TtsTemplates` SET `isDefault` = 0;
    END IF;
END$$
DELIMITER ;

-- 查看创建的表结构
DESCRIBE `TtsTemplates`;

-- 查看插入的数据
SELECT * FROM `TtsTemplates` ORDER BY `sortOrder` ASC;

-- 2. 查看更新后的表结构
DESCRIBE Devices;

-- 3. 为现有设备设置默认值（可选）
UPDATE `Devices` 
SET `apiEnabled` = 0, 
    `apiCallCount` = 0 
WHERE `apiEnabled` IS NULL;

-- 4. 查看更新结果
SELECT id, name, devId, apiUrl, apiToken, apiEnabled, lastApiCallTime, apiCallCount 
FROM Devices;

-- 更新现有记录为短信类型
UPDATE `SmsMessages` SET `msgType` = 'sms' WHERE `msgType` IS NULL;

UNLOCK TABLES;



/*!40111 SET SQL_NOTES=@OLD_SQL_NOTES */;
/*!40101 SET SQL_MODE=@OLD_SQL_MODE */;
/*!40014 SET FOREIGN_KEY_CHECKS=@OLD_FOREIGN_KEY_CHECKS */;
/*!40101 SET CHARACTER_SET_CLIENT=@OLD_CHARACTER_SET_CLIENT */;
/*!40101 SET CHARACTER_SET_RESULTS=@OLD_CHARACTER_SET_RESULTS */;
/*!40101 SET COLLATION_CONNECTION=@OLD_COLLATION_CONNECTION */;
